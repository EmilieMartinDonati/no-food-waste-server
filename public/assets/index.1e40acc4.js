var X=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var K=(t,s,n)=>s in t?X(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,_=(t,s)=>{for(var n in s||(s={}))se.call(s,n)&&K(t,n,s[n]);if(Y)for(var n of Y(s))ne.call(s,n)&&K(t,n,s[n]);return t},U=(t,s)=>ee(t,te(s));import{r,j as F,u as k,N as T,a as G,K as ae,T as re,f as Z,b as oe,F as le,L as V,G as L,c as H,d as z,e as ce,O as ie,g as $,h as de,R as ue,i as S,k as he,l as me,B as pe}from"./vendor.8be47e08.js";const ge=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))d(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const g of i.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&d(g)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerpolicy&&(i.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?i.credentials="include":a.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function d(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}};ge();const J=r.exports.createContext(),D=()=>r.exports.useContext(J),e=F.exports.jsx,o=F.exports.jsxs,b=F.exports.Fragment,fe=()=>{const{isLoggedIn:t,currentUser:s,removeUser:n}=D(),d=k(),a=()=>{n(),d("/")};return o("nav",{className:"navbar navbar-dark bg-dark px-5 py-3",children:[!t&&o(b,{children:[e(T,{className:"nav-link",to:"/",children:"Home"}),e(T,{className:"nav-link",to:"/login",children:"Log in"}),e(T,{className:"nav-link",to:"/signup",children:"Sign up"})]}),t&&o(b,{children:[s.role==="user"&&o(b,{children:[e(T,{className:"nav-link",to:"/listings",children:"Search"}),e(T,{className:"nav-link",to:"/favorites",children:"Favorites"})]}),s.role==="business"&&e(T,{className:"nav-link",to:"/dashboard",children:"Dashboard"}),e(T,{className:"nav-link",to:"/account",children:"My account"}),e("button",{className:"btn btn-danger",onClick:a,children:"Log out"})]})]})},ve=({setRole:t})=>{const{isLoggedIn:s,currentUser:n}=D(),d=k();return o("div",{children:[!s&&o("div",{id:"cover-image-auth-role",children:[e("h1",{style:{"font-size":"7rem",color:"white"},className:"py-5",children:"How will you help us stop wasting food?"}),e("button",{className:"btn btn-primary mx-4 px-3",onClick:()=>{t("user"),d("/signup")},children:"I will buy food"}),e("button",{className:"btn btn-primary mx-4 px-3",onClick:()=>{t("business"),d("/signup")},children:"I will sell food"})]}),s&&n.role==="user"&&d("/discover"),s&&n.role==="business"&&d("/dashboard")]})},P=G.create({baseURL:"https://no-food-waste-2911.herokuapp.com",withCredentials:!0});P.interceptors.request.use(t=>{const s=localStorage.getItem("authToken");return t.headers.Authorization=s?`Bearer ${s}`:"",t});//! Error handling to use in the catch
function B(t){var s,n;throw((s=t.response)==null?void 0:s.data)&&console.log(t.response&&((n=t.response)==null?void 0:n.data)),t}const x=U(_({},P),{signup(t){return P.post("/api/auth/signup",t).then(s=>{console.log(s)}).catch(B)},isLoggedIn(t){return P.get("/api/auth/me",{headers:{Authorization:`Bearer ${t}`}}).then(s=>s.data).catch(B)},signin(t){return P.post("/api/auth/signin",t).then(s=>s.data).catch(B)}}),Ne=({role:t})=>{const[s,n]=r.exports.useState(""),[d,a]=r.exports.useState(""),i=k(),{storeToken:g,authenticateUser:f,currentUser:u}=D();return console.log("This is current user",u),o(b,{children:[e("h1",{className:"pt-5",children:"Sign in"}),o("form",{className:"pb-5",onSubmit:l=>{const v={email:s,password:d};console.log("data in AuthSignin line 20",v),l.preventDefault(),x.signin(v).then(h=>{g(h.authToken),f(),u.role==="user"?i("/discover"):i("/dashboard")}).catch(h=>console.log(h))},children:[o("div",{className:"form-group p-5",children:[e("label",{className:"m-3",htmlFor:"email",children:"EMAIL"}),e("input",{className:"form-control",type:"text",name:"email",required:!0,onChange:l=>n(l.target.value)}),e("label",{className:"m-3",htmlFor:"password",children:"PASSWORD"}),e("input",{className:"form-control",type:"password",name:"password",required:!0,onChange:l=>a(l.target.value)})]}),e("button",{className:"btn btn-primary px-5 py-2",children:"LOG IN"})]})]})},M=G.create({baseURL:"https://no-food-waste-2911.herokuapp.com",withCredentials:!0});M.interceptors.request.use(t=>{const s=localStorage.getItem("authToken");return t.headers.Authorization=s?`Bearer ${s}`:"",t});//! Error handling to use in the catch
function j(t){var s,n;throw((s=t.response)==null?void 0:s.data)&&console.log(t.response&&((n=t.response)==null?void 0:n.data)),t}const R=U(_({},M),{signup(t){return M.post("/api/auth/signup",t).then(s=>{console.log(s)}).catch(j)},isLoggedIn(t){return M.get("/api/auth/me",{headers:{Authorization:`Bearer ${t}`}}).then(s=>s.data).catch(j)},signin(t){return M.post("/api/auth/signin",t).then(s=>s.data).catch(j)}}),ye=({role:t})=>{const[s,n]=r.exports.useState({name:"",email:"",password:"",role:t});console.log(s);const d=k();return o(b,{children:[e("h2",{className:"pt-5",children:"Create an account"}),o("form",{onSubmit:g=>{g.preventDefault(),console.log("during the handleSubmit",s),R.signup(s).then(f=>{console.log("This is coming back from the server !",f),d("/login")}).catch(f=>{console.log("THIS IS THE ERROR",f)})},onChange:g=>{n(f=>U(_({},f),{[g.target.id]:g.target.value})),console.log("after the handleChange",s)},className:"pb-5",children:[o("div",{className:"form-group p-5",children:[e("label",{className:"m-3",htmlFor:"name",children:"NAME"}),e("input",{className:"form-control",type:"text",id:"name",required:!0}),e("label",{className:"m-3",htmlFor:"email",children:"EMAIL"}),e("input",{className:"form-control",type:"text",id:"email",required:!0}),e("label",{className:"m-3",htmlFor:"password",children:"PASSWORD"}),e("input",{className:"form-control",type:"password",id:"password",required:!0})]}),e("button",{className:"btn btn-primary px-5 py-2",children:"SIGN UP"})]}),e(T,{to:"/login",role:t,children:e("h3",{children:"Already registered ? Log in"})})]})},be=({setBusiness:t,setStep:s})=>{const[n,d]=r.exports.useState(""),[a,i]=r.exports.useState(""),[g,f]=r.exports.useState(""),[u,p]=r.exports.useState(""),l=r.exports.useRef(""),v=h=>{h.preventDefault(),t(c=>U(_({},c),{name:n,address:a,phone:g,description:u,picture:l.current.files[0]})),s(2)};return o("form",{className:"p-4",children:[e("h2",{children:"Describe your business"}),e("p",{children:"Please tell us a little bit more about your business so that we can settle your account"}),e("h3",{children:"Confirm the name and location of your business"}),e("div",{className:"form-group m-3",children:e("input",{className:"form-control",type:"text",name:"name",placeholder:"Name of your business",onChange:h=>d(h.target.value)})}),e("div",{className:"form-group m-3",children:e("input",{className:"form-control",type:"text",name:"address",placeholder:"Address of your business",onChange:h=>i(h.target.value)})}),e("div",{className:"form-group m-3",children:e("input",{className:"form-control",type:"number",name:"phone",placeholder:"Phone number",onChange:h=>f(Number(h.target.value))})}),e("div",{className:"form-group m-3",children:e("input",{className:"form-control",type:"text",name:"description",placeholder:"Give us a quick description of your business",onChange:h=>p(h.target.value)})}),e("p",{children:"You can also provide a picture for your business. While not mandatory, it will help users differentiating your listings with others."}),e("div",{className:"form-group m-3",children:e("input",{className:"form-control-file",ref:l,type:"file",name:"picture"})}),e("button",{className:"btn btn-primary px-5 py-2",onClick:h=>v(h),children:"Register"})]})},xe=({setBusiness:t,setStep:s})=>{const[n,d]=r.exports.useState([]),[a,i]=r.exports.useState([]);r.exports.useEffect(()=>{x.get("/api/category").then(u=>{console.log("dbRes.data line 13 >>>>>>>",u.data),d(u.data)}).catch(u=>console.error(u))},[]),console.log("Options >>> line 16",n);const g=u=>{const p=[],l=u.target.selectedOptions;for(let v=0;v<l.length;v++)p.push(l[v].value);i(p)},f=u=>{u.preventDefault(),t(p=>U(_({},p),{tags:a})),s(3)};return o("form",{className:"p-4",children:[e("h2",{children:"Describe the products you sell"}),e("p",{children:"Tell us what kind of products you will be selling. This information will appear in the app."}),e("h3",{children:"Which tags best describe your business and products?"}),e("div",{className:"dropdown m-3",children:e("select",{type:"text",name:"tags",placeholder:"Select all relevant tags",onChange:u=>g(u),multiple:!0,children:n&&n.map(u=>e("option",{className:"dropdown-item",value:u._id,children:u.name}))})}),e("button",{className:"btn btn-primary",onClick:u=>f(u),children:"Ok"})]})},Se=({business:t})=>{const[s,n]=r.exports.useState(null),[d,a]=r.exports.useState(null),i=k(),g=p=>{n(new Date(p.target.value))},f=p=>{a(new Date(p.target.value))},u=p=>{p.preventDefault();const l=new FormData;l.append("name",t.name),l.append("address",t.address),l.append("phone",t.phone),l.append("description",t.description),l.append("picture",t.picture),l.append("tags",t.tags),l.append("startTimeSlot",s),l.append("endTimeSlot",d),x.post("/api/business/create",l).then(()=>{console.log("Hey, do you arrive here??????"),i("/dashboard")}).catch(v=>console.error(v))};return o("form",{className:"p-4",children:[e("h2",{children:"At what time can users pick up their order?"}),e("p",{children:"Set your timeslots below for pickup. Note that the majority of our partners set this timeslot between 15 to 30 minutes before closing."}),e("label",{htmlFor:"startTime"}),e("input",{className:"m-3",type:"datetime-local",id:"startTime",onChange:p=>g(p)}),e("label",{htmlFor:"endTime"}),e("input",{className:"m-3",type:"datetime-local",id:"endTime",onChange:p=>f(p)}),e("button",{className:"btn btn-primary",onClick:p=>u(p),children:"Register timeslots"})]})},we=()=>{const[t,s]=r.exports.useState(1),[n,d]=r.exports.useState({owner:"",name:"",phone:"",address:"",description:"",picture:"",listings:[],tags:[],timeSlots:[]});return o("div",{children:[e(b,{children:"Hello"}),t===1&&e(be,{setBusiness:d,setStep:s}),t===2&&e(xe,{setBusiness:d,setStep:s}),t===3&&e(Se,{business:n})]})},ke=({business:t,setBusiness:s})=>{const n=k(),d=i=>{n(`/listings/${i}/update`)},a=i=>{x.delete(`/api/listings/${t._id}/delete/${i}`).then(g=>{s(g.data)}).catch(g=>console.error(g))};return o(b,{children:[e("img",{className:"mt-5",style:{width:200},src:t.picture,alt:t.name}),e("h1",{className:"p-5",children:t.name}),!t.listings.length&&e("p",{children:"You don't have any listings for the moment"}),t.listings.length>0&&o(b,{children:[e("h2",{className:"p-3",children:"My listings"}),o("div",{className:"container m-5",children:[o("div",{className:"row",children:[e("strong",{className:"col-sm p-4",children:"Name"}),e("strong",{className:"col-sm p-4",children:"Price"}),e("strong",{className:"col-sm p-4",children:"Available quantity"}),e("strong",{className:"col-sm p-4",children:"Description"}),e("strong",{className:"col-sm p-4",children:"Modify"}),e("strong",{className:"col-sm p-4",children:"Delete"})]}),t.listings.map(i=>o("div",{className:"row",children:[e("span",{className:"col-sm p-4",children:i.name}),o("span",{className:"col-sm p-4",children:[i.price," \u20AC"]}),e("span",{className:"col-sm p-4",children:i.availableQuantity}),e("span",{className:"col-sm p-4",children:i.description}),e("span",{style:{cursor:"pointer"},onClick:()=>d(i._id),className:"col-sm p-4",children:e(ae,{size:24})}),e("span",{style:{cursor:"pointer"},onClick:()=>a(i._id),className:"col-sm p-4",children:e(re,{size:24})})]},i._id))]})]}),e("button",{className:"btn btn-primary px-5 py-2",onClick:()=>n("/listings/create",{state:{businessId:t._id}}),children:"Add a listing"})]})},Ce=()=>{const{currentUser:t}=D(),[s,n]=r.exports.useState(""),d=k();return r.exports.useEffect(()=>{x.get("/api/business").then(a=>a.data.find(i=>i.owner===t._id)).then(a=>n(a)).catch(a=>console.error(a))},[]),o("div",{children:[!s&&o("div",{children:[e("p",{className:"p-5",children:"Vous n'avez pas encore de business enregistr\xE9"}),e("button",{className:"btn btn-primary py-2 px-5",onClick:()=>d("/onboarding"),children:"New business"})]}),s&&e(ke,{business:s,setBusiness:n})]})},Q=({listing:t})=>{const[s,n]=r.exports.useState(Z),[d,a]=r.exports.useState(""),[i,g]=r.exports.useState(""),{currentUser:f,storeToken:u}=D();r.exports.useEffect(()=>{f.favorites.includes(t.owner._id)?n(oe):n(Z)},[f]),r.exports.useEffect(()=>{const h=setInterval(()=>{l()},1e3);return()=>clearInterval(h)},[]);const p=(h,c)=>Math.round(Math.abs(h-c)/1e3/60),l=()=>{new Date().getHours()<new Date(t.owner.startTimeSlot).getHours()?(a("Will open soon"),g("green")):new Date().getHours()>new Date(t.owner.endTimeSlot).getHours()?(a("Come back tomorrow"),g("black")):p(new Date(t.owner.endTimeSlot).getHours(),new Date().getHours())<60?(a("Will close soon"),g("red")):new Date().getHours()===new Date(t.owner.endTimeSlot)&&(new Date().getMinutes()<new Date(t.owner.startTimeSlot).getMinutes()?(a("Will open in less than an hour"),g("green")):new Date().getMinutes()>new Date(t.owner.endTimeSlot).getMinutes()?(a("You just missed it ... Come back tomorrow!"),g("black")):p(new Date(t.owner.endTimeSlot).getMinutes(),new Date().getMinutes())<60&&(a("Will close in less than an hour"),g("red")))},v=()=>{x.patch(`/account/favorites/${t.owner._id}`).then(h=>{u(h.data)}).catch(h=>console.error(h))};return o("div",{className:"card",style:{width:"30rem"},children:[e("img",{className:"card-img-top",src:t.owner.picture,alt:t.name}),o("div",{className:"card-body",children:[e("p",{style:{backgroundColor:i,color:"white"},children:d}),e("h5",{className:"card-title",children:t.name}),o("h5",{className:"card-text",children:["Price: ",t.price,"\u20AC"]}),e("p",{className:"card-text",children:t.owner.name}),e(le,{style:{cursor:"pointer"},onClick:v,icon:s,size:"xs"}),o("p",{className:"card-text",children:["Pick up by ",t.owner.pickupTimeSlots]}),e("p",{children:t.availableQuantity}),e(V,{to:`/listing/${t._id}`,children:"See this offer"})]})]})};L.setApiKey("AIzaSyAWNUhMz1o6js88esl8_xmRkQgFOZr38nk");L.setLanguage("fr");const Ae=()=>{const[t,s]=r.exports.useState(0),[n,d]=r.exports.useState(0),[a,i]=r.exports.useState([]),[g,f]=r.exports.useState("");L.fromLatLng(t,n).then(l=>{const v=l.results[0].formatted_address;let h,c,N;for(let C=0;C<l.results[0].address_components.length;C++)for(let I=0;I<l.results[0].address_components[C].types.length;I++)switch(l.results[0].address_components[C].types[I]){case"locality":h=l.results[0].address_components[C].long_name;break;case"administrative_area_level_1":c=l.results[0].address_components[C].long_name;break;case"country":N=l.results[0].address_components[C].long_name;break}console.log(h,c,N),f(v)},l=>{console.error(l)});const u={width:"auto",height:"400px"},p={lat:t,lng:n};return r.exports.useEffect(()=>{"geolocation"in navigator?console.log("Available"):console.log("Not Available"),navigator.geolocation.getCurrentPosition(function(l){console.log("Latitude is :",l.coords.latitude),s(l.coords.latitude),console.log("Longitude is :",l.coords.longitude),d(l.coords.longitude)}),x.get("/discover").then(l=>{console.log("this is db Res for allListings",l),i(l.data)}).catch(l=>console.error(l))},[]),e("div",{children:o("div",{className:"container",children:[o("div",{className:"row",children:[o("div",{className:"col-4",children:[e("h1",{className:"text-center text-danger",children:"Discover"}),o("p",{children:["Offers near ",e("span",{style:{color:"slategrey"},children:g})]})]}),e("div",{className:"col-8",children:e(H,{googleMapsApiKey:"AIzaSyAWNUhMz1o6js88esl8_xmRkQgFOZr38nk",children:e(z,{mapContainerStyle:u,center:p,zoom:10})})})]}),e("div",{className:"row",children:e("div",{className:"col-12 d-inline-flex",children:a.map(l=>e(Q,{listing:l}))})}),e("div",{className:"row",children:o("div",{className:"col-12",children:[e("h1",{className:"text-center text-danger",children:"Our approach"}),e("p",{children:"No-food-waste is an ecofriendly society that allows restaurant owners to sell their unsold stocks to you under the form of of nicely packaged meals."})]})})]})})},Le=()=>{const{isLoggedIn:t,currentUser:s}=D();return t?e(ie,{}):(console.log("Hello I'm in private route live 11"),e(ce,{to:"/login"}))};L.setApiKey("AIzaSyAWNUhMz1o6js88esl8_xmRkQgFOZr38nk");L.setLanguage("fr");const Ie=()=>{const[t,s]=r.exports.useState(0),[n,d]=r.exports.useState(0),[a,i]=r.exports.useState([]),[g,f]=r.exports.useState(""),[u,p]=r.exports.useState("list");r.exports.useState(null),r.exports.useState(0);const[l,v]=r.exports.useState(""),[h,c]=r.exports.useState([]),N={width:"300px",height:"300px",marginLeft:"3%"};L.fromLatLng(t,n).then(m=>{const w=m.results[0].formatted_address;for(let y=0;y<m.results[0].address_components.length;y++)for(let A=0;A<m.results[0].address_components[y].types.length;A++)switch(m.results[0].address_components[y].types[A]){case"locality":m.results[0].address_components[y].long_name;break;case"administrative_area_level_1":m.results[0].address_components[y].long_name;break;case"country":m.results[0].address_components[y].long_name;break}f(w)},m=>{console.error(m)}),r.exports.useEffect(()=>{"geolocation"in navigator?console.log("Available"):console.log("Not Available"),navigator.geolocation.getCurrentPosition(function(m){console.log("Latitude is :",m.coords.latitude),s(m.coords.latitude),console.log("Longitude is :",m.coords.longitude),d(m.coords.longitude)}),R.get("/listings").then(m=>{console.log("this is the res from the db line 77",m),i(m.data.listings),c(m.data.categories)}).catch(m=>console.log(m))},[]),r.exports.useEffect(()=>{I()},[a]);const C=m=>new Promise(async(w,y)=>{try{let A=m.owner.address;const E=await L.fromAddress(A),{lat:O,lng:W}=E.results[0].geometry.location;console.log("lat long",O,W),w({lat:O,lng:W})}catch(A){y(A)}}),I=async()=>{console.log("waht is in listings ?",a);try{for(let m of a){const w=await C(m);console.log(">>",w),m.coord=w}}catch(m){console.error(m)}};return console.log("listings, I hope they have the coordinates",a),o("div",{className:"container ",children:[e("div",{className:"row",children:o("div",{className:"col-12",children:[e("h1",{className:"text-center text-danger",children:"BROWSE"}),o("p",{children:["Offers near"," ",e("span",{style:{color:"slategrey"},children:g})]})]})}),e("div",{className:"row",children:e("div",{className:"col-12",children:o("form",{onSubmit:m=>{m.preventDefault();const w={search:l};R.post("/category",w).then(y=>{console.log("this is the response for the cat line 133",y.data.listings),i(y.data.listings)}).catch(y=>console.log(y))},children:[e("label",{htmlFor:"search"}),e("select",{id:"search",onChange:m=>v(m.target.value),children:h.map(m=>(console.log(m),e("option",{value:m._id,children:m.name},m._id)))}),e("button",{type:"submit",children:"Search"})]})})}),o("div",{className:"row",children:[e("div",{className:"col-6",children:e("button",{className:"btn-info",value:"list",onClick:m=>p(m.target.value),children:"LIST"})}),e("div",{className:"col-6",children:e("button",{className:"btn-info",value:"map",onClick:m=>p(m.target.value),children:"MAP"})})]}),o("div",{className:"row",children:[u==="list"&&e("div",{className:"col-12 d-inline-flex justify-content-center",children:a.map(m=>e("div",{children:e(Q,{listing:m})},m._id))}),u==="map"&&o("div",{className:"col-12 d-inline-grid justify-content-center",children:[e("p",{className:"text-uppercase",children:"See on card"}),a.map(m=>{var y,A,E,O;const w={lat:(y=m.coord)==null?void 0:y.lat,lng:(A=m.coord)==null?void 0:A.lng};return o(b,{children:[e("h4",{children:m.name}),e("p",{children:m.owner.address}),e("p",{children:(E=m.coord)==null?void 0:E.lat}),e("p",{children:(O=m.coord)==null?void 0:O.lng}),e(H,{googleMapsApiKey:"AIzaSyAWNUhMz1o6js88esl8_xmRkQgFOZr38nk",children:e(z,{mapContainerStyle:N,center:w,zoom:20})})]})})]})]})]})},Te=()=>{const{currentUser:t}=D(),s=k(),n=r.exports.useRef(),[d,a]=r.exports.useState([]),[i,g]=r.exports.useState(0),[f,u]=r.exports.useState("");console.log("log line 10");const{id:p}=$();console.log("this is the id from the params on the front line 13",p),r.exports.useEffect(()=>{x.get("/listing/"+p).then(h=>{console.log("this is the relevant listing on the front",h.data),a(h.data)}).catch(h=>console.log("here err",h))},[]);const l=()=>{n.current.classList.toggle("collapse")},v=h=>{h.preventDefault(),console.log("this is the qty and payment",i,f),console.log("this is the current user",t);const c={quantity:i,payment:f,listing:d._id,buyer:t._id};x.post(`/listing/${p}`,c).then(N=>{console.log(N.data),s(`/account/bookings/${N.data._id}`)}).catch(N=>console.log(N))};return o(b,{children:[e("h1",{children:"Listing details"}),d.name&&e(Q,{listing:d}),e("p",{children:e("button",{onClick:l,className:"btn btn-primary",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseExample","aria-expanded":"false","aria-controls":"collapseExample",children:"BOOK THIS MEAL"})}),e("div",{className:"collapse",id:"collapseExample",ref:n,children:e("div",{className:"card card-body",children:o("form",{onSubmit:v,children:[e("label",{htmlFor:"label",className:"card-title",children:"Quantity"}),e("input",{type:"number",id:"label",min:"1",max:d.availableQuantity,onChange:h=>g(h.target.value)}),e("label",{htmlFor:"payment",children:"PAYMENT"}),o("select",{id:"payment",onChange:h=>u(h.target.value),children:[e("option",{id:"VISA",children:"VISA"}),e("option",{id:"MASTERCARD",children:"MASTERCARD"}),e("option",{id:"PAYPAL",children:"PAYPAL"})]}),e("button",{children:"CONCLUDE BOOKING"})]})})})]})},De=()=>{const[t,s]=r.exports.useState(""),[n,d]=r.exports.useState(""),[a,i]=r.exports.useState(""),[g,f]=r.exports.useState(""),[u,p]=r.exports.useState(!0),l=k(),{businessId:v}=de().state,h=c=>{c.preventDefault(),x.post(`/api/listings/${v}/create`,{name:t,price:n,availableQuantity:a,description:g,recurring:u}).then(N=>{console.log("This is dbRes from line 15 of CreatingList",N),l("/dashboard")}).catch(N=>console.error(N))};return o("form",{className:"p-4",children:[e("h2",{className:"mx-3",children:"Your listing's info"}),e("div",{className:"form-group m-3",children:e("input",{className:"form-control",type:"text",name:"name",placeholder:"Name of your listing",onChange:c=>s(c.target.value)})}),e("div",{className:"form-group m-3",children:e("input",{className:"form-control",type:"number",name:"price",placeholder:"How much?",onChange:c=>d(c.target.value)})}),e("div",{className:"form-group m-3",children:e("input",{className:"form-control",type:"number",name:"availableQuantity",placeholder:"How many?",onChange:c=>i(c.target.value)})}),e("div",{className:"form-group m-3",children:e("textarea",{className:"form-control",type:"text",name:"description",placeholder:"Please provide a short description",onChange:c=>f(c.target.value)})}),o("div",{className:"m-3",children:[e("h3",{children:"Is the listing reccuring?"}),e("label",{className:"mx-4",htmlFor:"recurring",children:"Yes"}),e("input",{type:"radio",idfor:"recurring",name:"recurring",value:!0,checked:u===!0,onChange:c=>p(c.target.value&&!0)}),e("label",{className:"mx-4",htmlFor:"recurring",children:"No"}),e("input",{type:"radio",idfor:"recurring",name:"recurring",checked:u===!1,value:!1,onChange:c=>p(c.target.value&&!1)})]}),e("button",{className:"btn btn-primary px-5 py-2",onClick:c=>h(c),children:"Create a new listing"})]})},_e=()=>{const[t,s]=r.exports.useState(""),[n,d]=r.exports.useState(""),[a,i]=r.exports.useState(""),[g,f]=r.exports.useState(""),[u,p]=r.exports.useState(""),l=k(),{listingId:v}=$();r.exports.useEffect(()=>{x.get(`/api/listings/${v}`).then(c=>{s(c.data.name),d(c.data.price),i(c.data.availableQuantity),f(c.data.description),p(c.data.recurring)}).catch(c=>console.error(c))},[v]);const h=c=>{c.preventDefault(),x.patch(`/api/listings/modify/${v}`,{name:t,price:n,availableQuantity:a,description:g,recurring:u}).then(()=>{l("/dashboard")}).catch(N=>console.error(N))};return o("form",{className:"p-4",onSubmit:c=>h(c),children:[e("h2",{className:"mx-3",children:"Your listing's info"}),e("div",{className:"form-group m-3",children:e("input",{className:"form-control",type:"text",name:"name",id:"name",value:t,onChange:c=>s(c.target.value)})}),e("div",{className:"form-group m-3",children:e("input",{className:"form-control",type:"number",name:"price",id:"price",value:n,onChange:c=>d(c.target.value)})}),e("div",{className:"form-group m-3",children:e("input",{className:"form-control",type:"number",name:"availableQuantity",id:"availableQuantity",value:a,onChange:c=>i(c.target.value)})}),e("div",{className:"form-group m-3",children:e("textarea",{className:"form-control",type:"text",name:"description",id:"description",value:g,onChange:c=>f(c.target.value)})}),o("div",{className:"m-3",children:[e("h3",{children:"Is the listing reccuring?"}),e("label",{className:"mx-4",htmlFor:"recurring",children:"Yes"}),e("input",{type:"radio",idfor:"recurring",name:"recurring",id:"recurring",value:!0,checked:u===!0,onChange:c=>p(c.target.checked&&!0)}),e("label",{className:"mx-4",htmlFor:"recurring",children:"No"}),e("input",{type:"radio",idfor:"recurring",name:"recurring",id:"recurring",value:!0,checked:u===!1,onChange:c=>p(c.target.value&&!1)})]}),e("button",{className:"btn btn-primary px-5 py-2",children:"Modify the listing"})]})},Ue=({booking:t})=>{var d,a,i,g,f,u,p,l;const s=k(),n=v=>{v.preventDefault(),x.delete(`/account/bookings/delete/${t._id}/${t.quantity}`).then(h=>{console.log(h.data),s("/account")}).catch(h=>console.log(h))};return e(b,{children:o("div",{className:"card",style:{width:"30rem"},children:[e("img",{className:"card-img-top",src:(a=(d=t.listing)==null?void 0:d.owner)==null?void 0:a.picture,alt:(i=t.listing)==null?void 0:i.name}),o("div",{className:"card-body",children:[o("h5",{className:"card-title",children:["Reserved quantity : ",t.quantity]}),o("h5",{className:"card-text",children:["Price: ",(g=t.listing)==null?void 0:g.price,"\u20AC"]}),e("p",{className:"card-text",children:(u=(f=t.listing)==null?void 0:f.owner)==null?void 0:u.address}),o("p",{className:"card-text",children:["Pick up by ",(l=(p=t.listing)==null?void 0:p.owner)==null?void 0:l.pickupTimeSlots]}),e("form",{onSubmit:n,children:e("button",{children:"Cancel booking"})})]})]})})},Oe=()=>{const[t,s]=r.exports.useState(""),[n,d]=r.exports.useState([]);return r.exports.useEffect(()=>{x.get("/account").then(a=>{console.log(a.data),s(a.data),d(a.data.bookings)}).catch(a=>console.log(a))},[]),o(b,{children:[o("h1",{children:["Welcome ",t.name]}),e("h3",{children:"Here are your bookings"}),n&&n.length>0&&n.map(a=>{var i,g,f,u,p,l,v,h;return e(b,{children:o("div",{className:"card",style:{width:"30rem"},children:[e("img",{className:"card-img-top",src:(g=(i=a.listing)==null?void 0:i.owner)==null?void 0:g.picture,alt:(f=a.listing)==null?void 0:f.name}),o("div",{className:"card-body",children:[o("h5",{className:"card-title",children:["Reserved quantity : ",a.quantity]}),o("h5",{className:"card-text",children:["Price: ",(u=a.listing)==null?void 0:u.price,"\u20AC"]}),e("p",{className:"card-text",children:(l=(p=a.listing)==null?void 0:p.owner)==null?void 0:l.address}),o("p",{className:"card-text",children:["Pick up by ",(h=(v=a.listing)==null?void 0:v.owner)==null?void 0:h.pickupTimeSlots]}),e(V,{to:`/account/bookings/${a._id}`,children:"See this booking"})]})]})})})]})};L.setApiKey("AIzaSyAWNUhMz1o6js88esl8_xmRkQgFOZr38nk");L.setLanguage("fr");const Pe=()=>{var u,p,l,v,h;const{id:t}=$();k();const[s,n]=r.exports.useState(null),[d,a]=r.exports.useState({}),i={width:"700px",height:"700px"};r.exports.useEffect(()=>{x.get(`/account/bookings/${t}`).then(c=>{console.log(c.data),n(c.data)}).catch(c=>console.log(c))},[t]),r.exports.useEffect(()=>{s!==null&&f()},[s]);const g=c=>new Promise(async(N,C)=>{try{let I=c.listing.owner.address;const q=await L.fromAddress(I),{lat:m,lng:w}=q.results[0].geometry.location;console.log("lat long",m,w),N({lat:m,lng:w})}catch(I){C(I)}}),f=async()=>{try{const c=await g(s);console.log(">>",c),a(c),console.log("this is the booking with the coordinates",s),console.log("this is lat and long",d)}catch(c){console.error(c)}};return console.log("booking",s),s&&((u=s==null?void 0:s.listing)==null?void 0:u.coord)&&console.log({lat:Number((l=(p=s==null?void 0:s.listing)==null?void 0:p.coord)==null?void 0:l.lat),lng:Number((h=(v=s==null?void 0:s.listing)==null?void 0:v.coord)==null?void 0:h.lng)}),e(b,{children:s&&o(b,{children:[e(Ue,{booking:s}),e(H,{googleMapsApiKey:"AIzaSyAWNUhMz1o6js88esl8_xmRkQgFOZr38nk",children:e(z,{mapContainerStyle:i,center:{lat:(d==null?void 0:d.lat)||45,lng:(d==null?void 0:d.lng)||50},zoom:20})})]})})},Me=()=>{const[t,s]=r.exports.useState([]);return r.exports.useEffect(()=>{x.get("/favorites").then(n=>s(n.data.favorites)).catch(n=>console.log(n))},[]),o(b,{children:[e("h3",{children:"Your favorites restaurant"}),t.map(n=>e(b,{children:o("div",{className:"card",style:{width:"30rem"},children:[e("img",{className:"card-img-top",src:n.picture,alt:n.name}),o("div",{className:"card-body",children:[e("h5",{className:"card-title",children:n.name}),e("p",{className:"card-text",children:n.description})]})]})}))]})};function Ee(){const[t,s]=r.exports.useState("user");return o("div",{className:"App",children:[e(fe,{}),o(ue,{children:[e(S,{path:"/",element:e(ve,{setRole:s})}),e(S,{path:"/signup",element:e(ye,{role:t})}),e(S,{path:"/login",element:e(Ne,{role:t})}),o(S,{element:e(Le,{}),children:[e(S,{path:"/discover",element:e(Ae,{})}),e(S,{path:"/category"}),e(S,{path:"/account",element:e(Oe,{})}),e(S,{path:"/account/bookings/:id",element:e(Pe,{})}),e(S,{path:"/dashboard",element:e(Ce,{})}),e(S,{path:"/onboarding",element:e(we,{})}),e(S,{path:"/listings/create",element:e(De,{})}),e(S,{path:"/listings/:listingId/update",element:e(_e,{})}),e(S,{path:"/favorites",element:e(Me,{})})]}),e(S,{path:"/listings",element:e(Ie,{})}),e(S,{path:"/listing/:id",element:e(Te,{})})]})]})}const Re=({children:t})=>{const[s,n]=r.exports.useState({currentUser:null,isLoading:!0,isLoggedIn:!1});r.exports.useEffect(()=>{d()},[]);const d=()=>{const u=localStorage.getItem("authToken");u?R.isLoggedIn(u).then(p=>{console.log(p),n({currentUser:p,isLoading:!1,isLoggedIn:!0})}).catch(p=>{n({currentUser:null,isLoading:!1,isLoggedIn:!1})}):n({currentUser:null,isLoading:!1,isLoggedIn:!1})},a=()=>{i(),d()},i=()=>{localStorage.removeItem("authToken")},g=u=>{localStorage.setItem("authToken",u),d()},f={currentUser:s.currentUser,isLoading:s.isLoading,isLoggedIn:s.isLoggedIn,removeUser:a,storeToken:g,authenticateUser:d};return e(J.Provider,{value:f,children:t})};he.render(e(me.StrictMode,{children:e(pe,{children:e(Re,{children:e(Ee,{})})})}),document.getElementById("root"));
